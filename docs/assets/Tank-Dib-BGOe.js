import{_ as S,r as i,f as B,a as g,b as s,g as C,t as d,u as h,i as y,l as E,o as k}from"./index-u-NLfMXx.js";const L={class:"tank-container"},P={class:"info"},T=["disabled"],j={key:0},F={__name:"Tank",setup(N){y("lang"),y("setLang");const v=y("t");E();const m=i(null);let t,x,M;const a=i({x:200,y:250,dir:0}),l=i([]),n=i([]),f=i(0),u=i(!1),o=i(!1),c=i(!1);function b(){a.value={x:200,y:250,dir:0},l.value=[],n.value=Array.from({length:5},()=>({x:Math.random()*360+20,y:Math.random()*100+20,dir:Math.random()*2*Math.PI})),f.value=0,u.value=!0,o.value=!1,c.value=!1,_(),M=setInterval(R,400)}function _(){w(),A(),o.value||(x=requestAnimationFrame(_))}function w(){for(let e of l.value)e.x+=Math.cos(e.dir)*8,e.y+=Math.sin(e.dir)*8;l.value=l.value.filter(e=>e.x>0&&e.x<400&&e.y>0&&e.y<300);for(let e=n.value.length-1;e>=0;e--)for(let r=l.value.length-1;r>=0;r--)if(Math.abs(n.value[e].x-l.value[r].x)<18&&Math.abs(n.value[e].y-l.value[r].y)<18){n.value.splice(e,1),l.value.splice(r,1),f.value++;break}for(let e of n.value)if(Math.abs(a.value.x-e.x)<22&&Math.abs(a.value.y-e.y)<22){p(!1);return}n.value.length===0&&p(!0)}function A(){t.clearRect(0,0,400,300),t.save(),t.translate(a.value.x,a.value.y),t.rotate(a.value.dir),t.fillStyle="#3a3",t.fillRect(-15,-15,30,30),t.fillStyle="#080",t.fillRect(0,-5,20,10),t.restore(),t.fillStyle="#333";for(let e of l.value)t.beginPath(),t.arc(e.x,e.y,5,0,Math.PI*2),t.fill();t.fillStyle="#f33";for(let e of n.value)t.fillRect(e.x-15,e.y-15,30,30)}function R(){for(let e of n.value)e.dir+=(Math.random()-.5)*.8,e.x+=Math.cos(e.dir)*10,e.y+=Math.sin(e.dir)*10,e.x=Math.max(15,Math.min(385,e.x)),e.y=Math.max(15,Math.min(285,e.y))}function p(e){u.value=!1,o.value=!0,c.value=e,cancelAnimationFrame(x),clearInterval(M)}function I(e){u.value&&(e.key==="ArrowLeft"&&(a.value.dir-=.2),e.key==="ArrowRight"&&(a.value.dir+=.2),e.key==="ArrowUp"&&(a.value.x+=Math.cos(a.value.dir)*10,a.value.y+=Math.sin(a.value.dir)*10,a.value.x=Math.max(15,Math.min(385,a.value.x)),a.value.y=Math.max(15,Math.min(285,a.value.y))),e.key===" "&&l.value.push({x:a.value.x+Math.cos(a.value.dir)*20,y:a.value.y+Math.sin(a.value.dir)*20,dir:a.value.dir}))}return B(()=>{t=m.value.getContext("2d"),window.addEventListener("keydown",I)}),(e,r)=>(k(),g("div",L,[r[0]||(r[0]=s("h2",null,"坦克大战",-1)),s("canvas",{ref_key:"canvas",ref:m,width:"400",height:"300",class:"game-canvas"},null,512),s("div",P,[s("div",null,"分数: "+d(f.value),1),s("button",{onClick:b,disabled:u.value},d(h(v)("start")),9,T),o.value?(k(),g("div",j,d(c.value?h(v)("victory"):h(v)("gameOver")),1)):C("",!0)])]))}},V=S(F,[["__scopeId","data-v-7f4de0ce"]]);export{V as default};
