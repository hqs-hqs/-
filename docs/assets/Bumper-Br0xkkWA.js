import{_ as C,r as n,f as F,e as R,a as M,b as r,g as U,t as x,u as b,i as d,l as D,o as I}from"./index-u-NLfMXx.js";const q={class:"bumper-container"},K={class:"info"},N=["disabled"],O={key:0},V={__name:"Bumper",setup(j){d("lang"),d("setLang");const m=d("t");D();const h=n(null);let t,i,u;const o=n({x:100,y:200,vx:0,vy:0,r:22,color:"#1976d2",score:0}),l=n([]),y=n([]),c=n(0),v=n(!1),s=n(!1);function L(){cancelAnimationFrame(i),clearInterval(u),o.value={x:100,y:200,vx:0,vy:0,r:22,color:"#1976d2",score:0},l.value=[{x:500,y:100,vx:2,vy:1.5,r:22,color:"#e53935",score:0},{x:500,y:300,vx:-2,vy:-1.5,r:22,color:"#43a047",score:0}],y.value=[{x:300,y:200,r:30}],c.value=0,v.value=!0,s.value=!1,p(),u=setInterval(E,100)}function p(){B(),P(),s.value||(i=requestAnimationFrame(p))}function B(){o.value.x+=o.value.vx,o.value.y+=o.value.vy,k(o.value);for(let e of l.value)e.x+=e.vx,e.y+=e.vy,k(e);for(let e of l.value)f(o.value,e)&&(c.value++,e.vx=-e.vx,e.vy=-e.vy);for(let e of l.value)for(let a of l.value)e!==a&&f(e,a)&&(e.vx=-e.vx,e.vy=-e.vy);for(let e of y.value){if(f(o.value,e)){S();return}for(let a of l.value)f(a,e)&&(a.vx=-a.vx,a.vy=-a.vy)}}function P(){t.clearRect(0,0,600,400),t.fillStyle="#888";for(let e of y.value)t.beginPath(),t.arc(e.x,e.y,e.r,0,Math.PI*2),t.fill();for(let e of l.value)t.beginPath(),t.arc(e.x,e.y,e.r,0,Math.PI*2),t.fillStyle=e.color,t.fill(),t.strokeStyle="#222",t.stroke();t.beginPath(),t.arc(o.value.x,o.value.y,o.value.r,0,Math.PI*2),t.fillStyle=o.value.color,t.fill(),t.strokeStyle="#222",t.stroke()}function k(e){e.x<e.r&&(e.x=e.r,e.vx=-e.vx),e.x>600-e.r&&(e.x=600-e.r,e.vx=-e.vx),e.y<e.r&&(e.y=e.r,e.vy=-e.vy),e.y>400-e.r&&(e.y=400-e.r,e.vy=-e.vy)}function f(e,a){const g=e.x-a.x,A=e.y-a.y;return Math.sqrt(g*g+A*A)<e.r+a.r}function S(){v.value=!1,s.value=!0,cancelAnimationFrame(i),clearInterval(u)}function E(){for(let e of l.value)Math.random()<.3&&(e.vx+=(Math.random()-.5)*1.2,e.vy+=(Math.random()-.5)*1.2,e.vx=Math.max(-3,Math.min(3,e.vx)),e.vy=Math.max(-3,Math.min(3,e.vy)))}function w(e){v.value&&(e.key==="ArrowLeft"&&(o.value.vx=-3),e.key==="ArrowRight"&&(o.value.vx=3),e.key==="ArrowUp"&&(o.value.vy=-3),e.key==="ArrowDown"&&(o.value.vy=3))}function _(e){v.value&&((e.key==="ArrowLeft"||e.key==="ArrowRight")&&(o.value.vx=0),(e.key==="ArrowUp"||e.key==="ArrowDown")&&(o.value.vy=0))}return F(()=>{t=h.value.getContext("2d"),window.addEventListener("keydown",w),window.addEventListener("keyup",_)}),R(()=>{cancelAnimationFrame(i),clearInterval(u),window.removeEventListener("keydown",w),window.removeEventListener("keyup",_)}),(e,a)=>(I(),M("div",q,[a[0]||(a[0]=r("h2",null,"碰碰车",-1)),r("canvas",{ref_key:"canvas",ref:h,width:"600",height:"400",class:"game-canvas"},null,512),r("div",K,[r("div",null,"得分: "+x(c.value),1),r("button",{onClick:L,disabled:v.value},x(b(m)("bumper.start")),9,N),s.value?(I(),M("div",O,x(b(m)("bumper.gameOver")),1)):U("",!0)])]))}},T=C(V,[["__scopeId","data-v-e89e8212"]]);export{T as default};
