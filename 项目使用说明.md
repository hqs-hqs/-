# 游戏平台项目使用说明

## 📋 项目简介

这是一个基于 Vue 3 + Spring Boot 开发的游戏平台项目，包含多个小游戏（打地鼠、五子棋、数独等），支持用户注册登录、游戏数据存储、排行榜、商城系统等功能。

## 🛠️ 技术栈

### 前端
- **Vue 3** - 渐进式 JavaScript 框架
- **Vite** - 下一代前端构建工具
- **Vue Router** - 官方路由管理器
- **Axios** - HTTP 客户端
- **CSS3** - 样式和动画

### 后端
- **Spring Boot 2.7.18** - Java 应用框架
- **Spring Data JPA** - 数据持久化框架
- **MySQL 8.0** - 关系型数据库（生产环境）
- **H2 Database** - 内存数据库（开发环境）
- **Maven** - 项目管理和构建工具

## 📦 环境要求

### 必需环境
- **Node.js** >= 16.0.0
- **npm** >= 8.0.0 或 **yarn**
- **Java JDK** 1.8（Java 8）
- **Maven** >= 3.6.0
- **MySQL** >= 8.0（生产环境使用）

### 推荐开发工具
- **IDE**: IntelliJ IDEA / VS Code
- **数据库管理**: MySQL Workbench
- **浏览器**: Chrome / Edge（最新版本）

## 🚀 快速开始


### 2. 安装前端依赖

```bash
# 在项目根目录执行
npm install
```

### 3. 配置数据库（生产环境）

#### 3.1 安装 MySQL

如果还没有安装 MySQL，请参考 `backend/MySQL安装配置指南.md` 进行安装。

#### 3.2 创建数据库

使用 MySQL Workbench 或命令行执行：

```sql
CREATE DATABASE IF NOT EXISTS game_db
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;
```

或者执行项目中的 SQL 脚本：

```bash
# 在 MySQL Workbench 中打开并执行
backend/create_database.sql
```

#### 3.3 配置数据库连接

编辑 `backend/src/main/resources/application.properties`：

```properties
# 修改为你的 MySQL 配置
spring.datasource.username=root
spring.datasource.password=你的MySQL密码
```

### 4. 配置前端环境变量

**重要**：由于后端默认使用 MySQL 数据库，前端需要配置环境变量以使用 API 模式连接后端。

创建 `.env` 文件（在项目根目录）：

```env
# API 基础地址
VITE_API_BASE_URL=http://localhost:8080/api

# 是否使用 API 模式（true/false）
VITE_USE_API=true
```

**说明**：
- **使用 API 模式**：设置 `VITE_USE_API=true`，前端会通过 API 连接后端 MySQL 数据库
- **不使用 API 模式**：如果不创建 `.env` 文件或设置 `VITE_USE_API=false`，前端会使用 `localStorage` 模式（数据存储在浏览器本地，不会保存到数据库）
- **推荐配置**：由于后端默认使用 MySQL，建议前端也配置为 API 模式，以实现数据持久化

### 5. 启动后端服务

**重要提示**：项目默认使用 **MySQL** 数据库。如果还没有配置 MySQL，请先完成步骤 3 的数据库配置。

#### 方式一：使用 IntelliJ IDEA

1. 打开项目，等待 Maven 依赖下载完成
2. 找到 `backend/src/main/java/com/game/GameApplication.java`
3. 右键选择 `Run 'GameApplication'`
4. **默认使用 MySQL**：直接运行即可（确保 MySQL 已启动并配置正确）
5. **如需使用 H2 数据库（开发环境）**：在运行配置中设置：
   - `Active profiles`: `dev`

#### 方式二：使用命令行

**使用 MySQL（默认）**：
```bash
cd backend
mvn spring-boot:run
```

**使用 H2 数据库（开发环境）**：
```bash
cd backend
mvn spring-boot:run -Dspring-boot.run.profiles=dev
```

后端服务将在 `http://localhost:8080` 启动。

**注意**：
- **默认配置**：项目默认使用 MySQL 数据库（`application.properties`）
- **开发环境**：如需使用 H2 内存数据库，需要激活 `dev` profile
- **首次运行**：会自动创建数据库表（`users`、`game_data`、`rank_records`）
- **MySQL 要求**：使用 MySQL 时，确保 MySQL 服务已启动，且已创建 `game_db` 数据库
- **H2 特点**：H2 是内存数据库，重启后数据会丢失，适合开发测试

### 6. 启动前端服务

```bash
# 在项目根目录执行
npm run dev
```

前端服务将在 `http://localhost:5173` 启动。

### 7. 访问项目

打开浏览器访问：`http://localhost:5173`

## 📁 项目结构

```
top1/
├── src/                          # 前端源代码
│   ├── api/                      # API 接口封装
│   │   └── index.js             # axios 配置和 API 方法
│   ├── assets/                  # 静态资源（图片、字体等）
│   ├── components/               # Vue 组件
│   │   ├── Hall.vue            # 游戏大厅
│   │   ├── WhackAMole.vue      # 打地鼠游戏
│   │   ├── Gobang.vue          # 五子棋游戏
│   │   ├── Sudoku.vue          # 数独游戏
│   │   ├── shop/                # 商城相关组件
│   │   └── SkinRepo.vue         # 皮肤仓库
│   ├── router/                  # 路由配置
│   │   └── index.js
│   ├── assets/                  # 资源文件
│   │   └── lang.js             # 国际化语言配置
│   ├── App.vue                  # 根组件
│   └── main.js                  # 入口文件
├── backend/                      # 后端源代码
│   ├── src/main/java/com/game/  # Java 源代码
│   │   ├── controller/          # 控制器层
│   │   ├── service/             # 业务逻辑层
│   │   ├── repository/          # 数据访问层
│   │   ├── entity/              # 实体类
│   │   └── GameApplication.java # 启动类
│   ├── src/main/resources/      # 配置文件
│   │   ├── application.properties      # 生产环境配置（MySQL）
│   │   └── application-dev.properties   # 开发环境配置（H2）
│   ├── create_database.sql      # 数据库创建脚本
│   └── pom.xml                  # Maven 依赖配置
├── public/                      # 公共静态资源
├── package.json                 # 前端依赖配置
├── vite.config.js               # Vite 配置
└── README.md                    # 项目说明
```

## ⚙️ 配置说明

### 后端配置

#### 生产环境（MySQL）

文件：`backend/src/main/resources/application.properties`

```properties
# 服务器端口
server.port=8080

# MySQL 数据库配置
spring.datasource.url=jdbc:mysql://localhost:3306/game_db?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
spring.datasource.username=root
spring.datasource.password=你的密码
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA 配置（自动创建/更新表）
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# 跨域配置
cors.allowed-origins=http://localhost:5173,http://localhost:5174
```

#### 开发环境（H2）

文件：`backend/src/main/resources/application-dev.properties`

在 IntelliJ IDEA 运行配置中设置 `Active profiles: dev` 即可使用 H2 内存数据库。

### 前端配置

#### API 模式配置

创建 `.env` 文件：

```env
VITE_API_BASE_URL=http://localhost:8080/api
VITE_USE_API=true
```

#### localStorage 模式（不推荐）

如果不创建 `.env` 文件或设置 `VITE_USE_API=false`，前端会使用 `localStorage` 模式，所有数据存储在浏览器本地，**不会保存到 MySQL 数据库**。

**注意**：由于后端默认使用 MySQL，建议前端也配置为 API 模式，以实现数据持久化。

### 切换配置模式

#### 使用 API 模式（推荐，连接 MySQL）

1. 确保后端服务已启动（默认使用 MySQL）
2. 创建 `.env` 文件并设置 `VITE_USE_API=true`
3. 重启前端服务

#### 使用 localStorage 模式（离线模式，不推荐）

1. 删除 `.env` 文件或设置 `VITE_USE_API=false`
2. 重启前端服务
3. **注意**：此模式下数据不会保存到数据库，仅存储在浏览器本地
